// Prisma schema for stripe-backend (minimal models used in tests)
generator client {
  provider = "prisma-client-js"
  // Generate query engine binaries for the build host and common runtimes
  // used in Docker images (musl/alpine and debian with OpenSSL 1.1).
  binaryTargets = ["native", "linux-musl", "debian-openssl-1.1.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Utilisateur {
  id                    Int      @id @default(autoincrement())
  username              String   @unique
  nom                   String?
  prenom                String?
  email                 String?  @unique
  telephone             String?  @unique
  localisation          String?
  description           String?
  mot_de_passe          String?
  date_inscription      DateTime @default(now())
  photo_profil          String?
  verification_identite Boolean  @default(false)
  preferences           String?
  annonces              Annonce[]
  utilisateurStripe     UtilisateurStripe?
}

model Annonce {
  id                     Int     @id @default(autoincrement())
  proprietaireId         Int
  titre                  String?
  localisation           String?
  description            String?
  consignesSpecifiques   String?
  typeGardeId            Int?
  dateDebut              DateTime?
  dateFin                DateTime?
  frequenceDeVisite      String?
  remuneration           Float?
  verificationIdentiteRequise Boolean @default(false)
  demandeUrgente         Boolean @default(false)
  statut                 String? @default("publie")
  dateCreation           DateTime @default(now())
  proprietaire           Utilisateur @relation(fields: [proprietaireId], references: [id])
}

model UtilisateurStripe {
  id               Int    @id @default(autoincrement())
  utilisateurId    Int    @unique
  stripeCustomerId String @unique
  utilisateur      Utilisateur @relation(fields: [utilisateurId], references: [id])
}

model TransactionAnnonce {
  id           Int    @id @default(autoincrement())
  stripeId     String
  annonceId    Int
  transactionId String
}
// NOTE: Payment and Transfer models removed â€” payments and transfer history
// are not persisted in the database in this schema. The backend may still
// simulate transfers in-memory for dev/test purposes, but production systems
// should rely on Stripe APIs for authoritative payment/transfer records.
